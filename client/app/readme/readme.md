# 文豪メッセンジャー

----

> 文豪とメッセンジャー友達だったら小説読むのが捗るんじゃないか的な

### 主な使い方

* 読みたい小説を`青空文庫`から探します
* 左上の`本のアイコン`から青空文庫の作品URLを入力します
* あとは最下部の`トークボタン`を押して読み進めましょう

### 役に立つ使い方

* トークボタンを押す代わりに、キーボードの`下矢印`、`スペースキー`、`エンターキー`を押すことでも読み進めることが可能
* 青空文庫インポート実行後は表示アドレスが書き換わるので、そのアドレスをブックマークすれば次回から任意の作品を開くことが出来る

### 運用上の注意

* 本サイトは個人の制作によるもので、herokuの無料プランの範疇で運用しています。そのためアクセスが集中するとサーバーが落ちることがあります
* 落ちた場合は10〜20分ほどで自動再起動されます。アクセスしづらい場合は夜中や早朝など空いている時間がおすすめです
* いったん作品の読み込みが完了すればあとはサーバーと通信しないので途中で切れることはありません

### 既知の問題

* 初めて見た人用に、トークボタンを押すことを促すなどもう少し分かりやすくしたい
* トップ中央に表示するのはメッセンジャーを意識して著者名にしているが、作品名のほうが便利ではないか
* メッセージ先頭末尾の空白を除去、しても良いものか

### 仕様

* 青空文庫の作品ページから`著者名`、`タイトル名`、`本文`を取得する
* `本文`から「」部分を抽出し、メッセンジャーの会話風に表示する
* 「」がネストされている場合は一番外側の物のみを使用する
 * 作品によっては「」が正しく閉じられていない場合もあり、その場合は、なんというかどうしようもない
 * 作品によっては「」がほとんど無い場合もあり、その場合は寂しい
* 会話以外の部分はお知らせメッセージとして表示する
* ルビ以外のタグは削除
* `著者名`で画像検索したうちの上位10件からランダムでプロフィールアイコンに設定
* `タイトル名`で画像検索した最大100件の画像リストからランダムでスタンプとして表示する（1メッセージ毎に5%の確率で表示）
* ログはデフォルトで直近50行のみ表示

### 今後対応するかもしれない事項

#### パフォーマンス

* サーバーキャッシュを実装してインポートを高速化
* クライアントキャッシュを実装して読み込み再開

#### 操作系

* トークボタン長押しで連続読み込み
* 1クリック単位のメッセージ読み込み量設定
* オートスクロール

#### 表示系

* 表示ログ行数の設定
* バックログ参照
* 会話部分だけ表示する設定
* スタンプの有無、表示確率設定


----

### 制作

* みやおか [@miyaoka](https://twitter.com/miyaoka)

----

### 謝辞

* [青空文庫](http://www.aozora.gr.jp/)
* [LINE](http://line.me/)
* [Google](http://google.com/)
